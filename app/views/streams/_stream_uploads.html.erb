<div class="card">
  <div class="card-header d-flex justify-content-between">
    <h3 class="h5 align-self-center mb-0">Files (<%= number_with_delimiter stream.files.size %> | <%= number_to_human_size stream.files.sum(:byte_size) %>)</h3>
    <%= link_to 'Upload file', new_organization_upload_path(@organization), class: 'btn btn-primary' %>
  </div>

  <% stream.uploads.each_with_index do |upload, ix| %>
    <ul class="list-group list-group-flush">
      <% upload.files.each do |file| %>
        <li class="list-group-item"><%= link_to file.filename, download_url(file) %> (<%= number_to_human_size file.byte_size %> / <%= file.content_type %>) (<%= file.metadata['count'] ? number_with_delimiter(file.metadata['count']) : '???' %>)</li>
      <% end %>
    </ul>
  <% end %>
</div>

<% if stream.normalized_dumps.last %>
  <div class="card mt-5">
    <div class="card-header d-flex justify-content-between">
      <h3 class="h5 align-self-center mb-0">Full Dumps</h3>
    </div>
    <ul class="list-group list-group-flush">
      <% stream.normalized_dumps.last.full_dump_binary.attachments.each do |attachment| %>
        <li class="list-group-item"><%= link_to attachment.filename, download_url(attachment) %> (<%= number_to_human_size attachment.byte_size %>)</li>
      <% end %>
      <% stream.normalized_dumps.last.full_dump_xml.attachments.each do |attachment| %>
        <li class="list-group-item"><%= link_to attachment.filename, download_url(attachment) %> (<%= number_to_human_size attachment.byte_size %>)</li>
      <% end %>
    </ul>
  </div>
  <div class="card mt-5">
    <div class="card-header d-flex justify-content-between">
      <h3 class="h5 align-self-center mb-0">Delta Dumps</h3>
    </div>
    <ul class="list-group list-group-flush">
      <% stream.normalized_dumps.last.delta_dump_binary.attachments.each do |attachment| %>
        <li class="list-group-item"><%= link_to attachment.filename, download_url(attachment) %> (<%= number_to_human_size attachment.byte_size %>)</li>
      <% end %>
      <% stream.normalized_dumps.last.delta_dump_xml.attachments.each do |attachment| %>
        <li class="list-group-item"><%= link_to attachment.filename, download_url(attachment) %> (<%= number_to_human_size attachment.byte_size %>)</li>
      <% end %>
    </ul>
  </div>
<% end %>
